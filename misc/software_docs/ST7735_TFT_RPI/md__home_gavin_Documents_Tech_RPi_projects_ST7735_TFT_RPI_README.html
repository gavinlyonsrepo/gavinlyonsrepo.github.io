<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ST7735_TFT_RPI: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ST7735_TFT_RPI
   &#160;<span id="projectnumber">1.6.0</span>
   </div>
   <div id="projectbrief">ST7735 Driver, Raspberry PI C++ library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://www.paypal.com/paypalme/whitelight976"><img src="https://img.shields.io/badge/Donate-PayPal-green.svg" alt="Donate" style="pointer-events: none;" class="inline"/></a></p>
<p><img src="https://github.com/gavinlyonsrepo/pic_16F18346_projects/blob/master/images/st7735/pcb.jpg" alt=" ig " class="inline"/></p>
<h2><a class="anchor" id="autotoc_md1"></a>
Table of contents</h2>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#software">Software</a> <br  />
</li>
<li><a href="#hardware">Hardware</a></li>
<li><a href="#output">Output</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Overview</h2>
<ul>
<li>Name: ST7735_TFT_RPI</li>
<li>Description:</li>
</ul>
<p>0. C++ Library for a TFT SPI LCD, ST7735 Driver</p><ol type="1">
<li>Dynamic install-able Raspberry Pi C++ library.</li>
<li>Inverse colour, rotate, sleep, idle &amp; vertical scroll modes supported.</li>
<li>8 fonts</li>
<li>Graphics + print class included.</li>
<li>24 bit colour , 16 bit color &amp; bi-color Bitmaps supported.</li>
<li>Hardware and Software SPI</li>
<li>Dependency: bcm2835 Library</li>
</ol>
<ul>
<li>Author: Gavin Lyons</li>
<li>Port of my PIC library at <a href="https://github.com/gavinlyonsrepo/pic_16F18346_projects">github link.</a></li>
<li>Created: May 2021</li>
<li>Developed on<ol type="1">
<li>Raspberry PI 3 model b</li>
<li>C++ g++ (Raspbian 8.3.0-6+rpi1) 8.3.0</li>
<li>Raspbian 10 Buster OS , armv7l Linux 5.10.63-v7</li>
<li>bcm2835 Library 1.68</li>
</ol>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Installation</h2>
<ol type="1">
<li>Make sure SPI bus is enabled on your raspberry PI</li>
<li>Install the dependency bcm2835 Library if not installed (at time of writing latest version is 1.68.)<ul>
<li>The bcm2835 library provides SPI bus, delays and GPIO control.</li>
<li>Install the C libraries of bcm2835, <a href="http://www.airspayce.com/mikem/bcm2835/">Installation instructions here</a></li>
</ul>
</li>
<li>Download the STT735_TFT_RPI library<ul>
<li>Open a Terminal in a folder where you want to download,build &amp; test library</li>
<li>Run following command to download from github.</li>
</ul>
</li>
</ol>
<div class="fragment"><div class="line">curl -sL https://github.com/gavinlyonsrepo/ST7735_TFT_RPI/archive/1.6.tar.gz | tar xz</div>
</div><!-- fragment --><ol type="1">
<li>Install library. Run "make" to run the makefile to install library, it will be installed to usr/lib and usr/include</li>
</ol>
<div class="fragment"><div class="line">cd ST7735_TFT_RPI-1.6</div>
<div class="line">sudo make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
Test</h2>
<ol type="1">
<li>Next step is to test TFT and installed library with the included main.cpp test example file. Wire up your TFT. Next enter the example folder and run the makefile in THAT folder, This second makefile builds the examples file using the just installed library, and creates a test exe file in "bin". Make run will use "sudo" as the bcm2835 requires root permissions by default <a href="http://www.airspayce.com/mikem/bcm2835/">see here for details</a> you should now see the test routines in that file running on the display. The example file is setup by default for a 128x128 red tab TFT.</li>
</ol>
<div class="fragment"><div class="line">cd example/</div>
<div class="line">make</div>
<div class="line">make run</div>
</div><!-- fragment --><ol type="1">
<li>There are three examples files. The default example file is Tests. To decide which one the makefile(In examples folder) builds simply edit "SRC" variable at top of the makefile. In the "User SRC directory Option Section" at top of file. Pick an example "SRC" directory path and ONE ONLY.</li>
</ol>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">#   </th><th class="markdownTableHeadNone">example file name   </th><th class="markdownTableHeadNone">Desc    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">src/Tests   </td><td class="markdownTableBodyNone">Tests text , fonts, bitmap ,functions    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">src/Hello_world   </td><td class="markdownTableBodyNone">basic use case    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">src/Frame_rate_test   </td><td class="markdownTableBodyNone">FPS speed testing   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md5"></a>
Software</h2>
<p><b>API</b></p>
<p>The API (application programming interface) documentation is at link hosted on github pages and generated by Doxygen.</p>
<p><a href="https://gavinlyonsrepo.github.io/misc/software_docs/ST7735_TFT_RPI/index.html">URL</a></p>
<p><b>USER OPTIONS</b></p>
<p>In the example files. There are 3 sections in "Setup()" function where user can make adjustments to select for SPI type used, PCB type used and screen size.</p>
<ol type="1">
<li>USER OPTION 1 GPIO/SPI TYPE</li>
<li>USER OPTION 2 SCREEN SECTION</li>
<li>USER OPTION 3 PCB_TYPE, SPI SPEED , SPI_CE_PIN</li>
</ol>
<p><b>USER OPTION 1 SPI TYPE / GPIO</b></p>
<p>This library supports both Hardware SPI and software SPI. The parameters set for TFTSetupGPIO define which is used, by default its Hardware. to switch between the two: set SCLK, SDIN and CS to -1 for HW SPI set them to valid GPIO numbers for SW SPI. HW SPI is far faster and more reliable than SW SPI If user is having reliability issues with SW SPI in some setups. The user can adjust the TFT_HIGHFREQ_DELAY setting in ST7735_TFT.h file, this is a microsecond delay in SW SPI loop. It is set to 0 by default, Increasing it will slow down SW SPI further.</p>
<p><b>USER OPTION 2 Screen size + Offsets</b></p>
<p>User can adjust screen pixel height, screen pixel width and x &amp; y screen offsets. These offsets can be used in the event of screen damage or manufacturing errors around edge such as cropped data or defective pixels. The function TFTInitScreenSize sets them.</p>
<p><b>USER OPTION 3 PCB Version, SPI SPEED , SPI_CE_PIN</b></p>
<p>TFTInitPCBType method</p>
<ol type="1">
<li>Param1 PCB_TYPE</li>
</ol>
<p>In the main.cpp in USER OPTION 3 PCB_TYPE select your display type. By passing an enum type to function TFTInitPCBType. Default is "TFT_ST7735R_Red". There are 4 types of the ST7735 TFT display supported. If your display works but RGB colors are inverted you may have chosen wrong display type.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Number   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Enum label   </th><th class="markdownTableHeadNone">Tested    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">ST7735B controller   </td><td class="markdownTableBodyNone">TFT_ST7735B   </td><td class="markdownTableBodyNone">n/a    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">ST7735R Green Tab   </td><td class="markdownTableBodyNone">TFT_ST7735R_Green   </td><td class="markdownTableBodyNone">n/a    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">ST7735R Red Tab   </td><td class="markdownTableBodyNone">TFT_ST7735R_Red   </td><td class="markdownTableBodyNone">RED PCB v1.1, 1.44, 128x128 pixels    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">ST7735S Black Tab   </td><td class="markdownTableBodyNone">TFT_ST7735S_Black   </td><td class="markdownTableBodyNone">RED PCB v1.2, 1.8, 128 x 160 pixels   </td></tr>
</table>
<ol type="1">
<li>Param2 SPI_Speed (HW SPI Only)</li>
</ol>
<p>Here the user can pass the SPI Bus freq in Hertz, Maximum 125 Mhz , Minimum 30Khz, The default in file is 8Mhz If you set to 0 .Speed is set to bcm2835 constant BCM2835_SPI_CLOCK_DIVIDER_32. If using SW spi, ignore.</p>
<ol type="1">
<li>Param3 SPI_CE_PIN (HW SPI Only)</li>
</ol>
<p>Which Chip enable pin to use two choices. If using SW spi, ignore.</p><ul>
<li>SPICE0 = 0</li>
<li>SPICE1 = 1</li>
</ul>
<p><b>Files</b></p>
<p>In example folder: The Main.cpp file contains tests showing library functions. A bitmap data file contains data for bi-color bitmaps and icons tests. The color bitmaps used in testing are in bitmap folder, 3 16-bit and 3 24-bit images.</p>
<p>There are two makefiles </p><pre class="fragment">1. At root directory builds and installs library at a system level.
2. Example directory builds example file + installed library to an executable.
</pre><p><b>Fonts</b></p>
<p>8 fonts available :</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">num   </th><th class="markdownTableHeadNone">name   </th><th class="markdownTableHeadNone">size xbyy   </th><th class="markdownTableHeadNone">ASCII range    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Default   </td><td class="markdownTableBodyNone">5x8   </td><td class="markdownTableBodyNone">Full Extended ASCII 0x00 - 0xFF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">Thick   </td><td class="markdownTableBodyNone">7x8   </td><td class="markdownTableBodyNone">ASCII 0x20 - 0x5A , no lowercase letters    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">Seven segment   </td><td class="markdownTableBodyNone">4x8   </td><td class="markdownTableBodyNone">ASCII 0x20 - 0x7A    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Wide   </td><td class="markdownTableBodyNone">8x8   </td><td class="markdownTableBodyNone">ASCII 0x20 - 0x5A , no lowercase letters    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">Tiny   </td><td class="markdownTableBodyNone">3x8   </td><td class="markdownTableBodyNone">ASCII 0x20 - 0x7A    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone">Homespun   </td><td class="markdownTableBodyNone">7x8   </td><td class="markdownTableBodyNone">ASCII 0x20 - 0x7A    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">7   </td><td class="markdownTableBodyNone">Big Nums   </td><td class="markdownTableBodyNone">16x32   </td><td class="markdownTableBodyNone">ASCII 0x2E-0x3A , Numbers + : . only    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">Med Nums   </td><td class="markdownTableBodyNone">16x16   </td><td class="markdownTableBodyNone">ASCII 0x2E-0x3A , Numbers + : . only   </td></tr>
</table>
<p>The fonts 1-6 are byte high(at text size 1) scale-able fonts, The large numerical Fonts, 7 &amp; 8 cannot be scaled.</p>
<p><b>Bitmap</b></p>
<p>There are four functions to support drawing bitmaps</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function Name   </th><th class="markdownTableHeadNone">Colour support   </th><th class="markdownTableHeadNone">Pixel size   </th><th class="markdownTableHeadNone">Note    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TFTdrawIcon   </td><td class="markdownTableBodyNone">bi-colour   </td><td class="markdownTableBodyNone">8 x(0-127)   </td><td class="markdownTableBodyNone">Data vertically addressed    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TFTdrawBitmap   </td><td class="markdownTableBodyNone">bi-colour   </td><td class="markdownTableBodyNone">2048 bytes max   </td><td class="markdownTableBodyNone">Data horizontally addressed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TFTdrawBitmap16   </td><td class="markdownTableBodyNone">16 bit color 565 BMP files   </td><td class="markdownTableBodyNone">32K max   </td><td class="markdownTableBodyNone">---&mdash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TFTdrawBitmap24   </td><td class="markdownTableBodyNone">24 bit color BMP files   </td><td class="markdownTableBodyNone">48K max   </td><td class="markdownTableBodyNone">Converted by software to 16-bit color   </td></tr>
</table>
<ol type="1">
<li>Bitmap size in kiloBytes = (screenWidth * screenHeight * bitsPerPixel)/(1024 * 8)</li>
<li>Pixel size column assumes 128 by 128 screen.</li>
</ol>
<h2><a class="anchor" id="autotoc_md6"></a>
Hardware</h2>
<p>Connections as setup in main.cpp test file.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">TFT PinNum   </th><th class="markdownTableHeadNone">Pindesc   </th><th class="markdownTableHeadNone">RPI HW SPI   </th><th class="markdownTableHeadNone">RPI SW SPI    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">LED   </td><td class="markdownTableBodyNone">VCC   </td><td class="markdownTableBodyNone">VCC    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">SCLK   </td><td class="markdownTableBodyNone">SPI_CLK   </td><td class="markdownTableBodyNone">GPIO5    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">SDA   </td><td class="markdownTableBodyNone">SPI_MOSI   </td><td class="markdownTableBodyNone">GPIO6    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">A0/DC   </td><td class="markdownTableBodyNone">GPIO24   </td><td class="markdownTableBodyNone">GPIO24    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">RESET   </td><td class="markdownTableBodyNone">GPI025   </td><td class="markdownTableBodyNone">GPIO25    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone">SS/CS   </td><td class="markdownTableBodyNone">SPI_CE0   </td><td class="markdownTableBodyNone">GPIO8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">7   </td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone">GND    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">VCC   </td><td class="markdownTableBodyNone">VCC   </td><td class="markdownTableBodyNone">VCC   </td></tr>
</table>
<ol type="1">
<li>Connect LED backlight pin 1 thru a 150R/220R ohm resistor to 3.3/5V VCC.</li>
<li>This is a 3.3V logic device do NOT connect the I/O logic lines to 5V logic device.</li>
<li>You can connect VCC to 5V if there is a 3.3 volt regulator on back of TFT module.</li>
<li>Pick any GPIO you want for SW SPI for HW SPI: reset and DC lines are flexible.</li>
<li>User can select SPI_CE0 or SPI_CE1 for HW SPI <img src="https://github.com/gavinlyonsrepo/ST7735_TFT_RPI/blob/main/extra/images/wiring.jpg" alt=" wiring " class="inline"/></li>
<li>Backlight control is left to user.</li>
</ol>
<h2><a class="anchor" id="autotoc_md7"></a>
Output</h2>
<p>Output of some of the test routine's. Left to right, top to bottom.</p>
<ol type="1">
<li>Different defined colors at default font size 1. Full 16 bit colour 565 available</li>
<li>Different sizes of default font. Size 2 3 4 &amp; 5 shown.</li>
<li>Different Fonts at font size 2, fonts 1-5. Are these fonts are scale-able, font 6 not shown.</li>
<li>Shapes</li>
<li>More Shapes!</li>
<li>Bitmap (bi-color) A background and a foreground.</li>
<li>Clock Demo showing icons, small bitmaps and font 7 "BigNums"</li>
<li>24-bit color bitmap test image</li>
<li>16-bit color bitmap test image</li>
</ol>
<p><img src="https://github.com/gavinlyonsrepo/pic_16F18346_projects/blob/master/images/st7735/9.jpg" alt=" pic " class="inline"/> <img src="https://github.com/gavinlyonsrepo/ST7735_TFT_RPI/blob/main/extra/images/4.jpg" alt=" pic1 " class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
