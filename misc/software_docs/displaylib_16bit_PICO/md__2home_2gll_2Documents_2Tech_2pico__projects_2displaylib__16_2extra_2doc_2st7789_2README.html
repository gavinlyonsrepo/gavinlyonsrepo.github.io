<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>displaylib_16bit_PICO: ST7789 Readme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">displaylib_16bit_PICO<span id="projectnumber">&#160;2.3.1</span>
   </div>
   <div id="projectbrief">Driver for 16-bit colour graphics displays,  Rpi PICO  library.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">ST7789 Readme</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md82"></a> <a href="https://gavinlyonsrepo.github.io/"><img src="https://img.shields.io/badge/Website-Link-blue.svg" alt="Website" style="pointer-events: none;" class="inline"/></a> <a href="https://gavinlyonsrepo.github.io//feed.xml"><img src="https://img.shields.io/badge/Subscribe-RSS-yellow.svg" alt="Rss" style="pointer-events: none;" class="inline"/></a> <a href="https://www.paypal.com/paypalme/whitelight976"><img src="https://img.shields.io/badge/Donate-PayPal-green.svg" alt="Donate" style="pointer-events: none;" class="inline"/></a></p>
<p><a href="https://github.com/gavinlyonsrepo/Display_Lib_RPI/blob/main/extra/images/st7789.jpg"><img src="https://github.com/gavinlyonsrepo/Display_Lib_RPI/blob/main/extra/images/st7789.jpg" alt="Image TFT" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md83"></a>
Table of contents</h1>
<ul>
<li>Overview</li>
<li><a class="el" href="test.html">Test</a></li>
<li>Software<ul>
<li>User Options</li>
<li>Bitmap</li>
</ul>
</li>
<li>Hardware</li>
<li>Output</li>
<li>Notes<ul>
<li>Display offsets</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md84"></a>
Overview</h1>
<ul>
<li>Name: ST7789_TFT_PICO</li>
<li>Description:</li>
</ul>
<p>C++ Raspberry pi PICO library for a TFT SPI LCD, ST7789 Driver</p>
<h1><a class="anchor" id="autotoc_md85"></a>
Test</h1>
<p>There are example files included. User picks the one they want by editing the CMakeLists.txt :: add_executable(${PROJECT_NAME} section. Comment in one path and one path only.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Filename   </th><th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Note    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">hello   </td><td class="markdownTableBodyNone">Hello world   </td><td class="markdownTableBodyNone">&mdash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">text   </td><td class="markdownTableBodyNone">Text + fonts   </td><td class="markdownTableBodyNone">&mdash;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">graphics   </td><td class="markdownTableBodyNone">Graphics   </td><td class="markdownTableBodyNone">&mdash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">functions_fps   </td><td class="markdownTableBodyNone">Functions(like rotate scroll) + FPS test   </td><td class="markdownTableBodyNone">&mdash;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">bmp_data   </td><td class="markdownTableBodyNone">1,8 &amp; 16 bit colour bitmaps tests + bitmap FPS test   </td><td class="markdownTableBodyNone">Bitmap data is stored in arrays on PICO    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">demos   </td><td class="markdownTableBodyNone">A demo   </td><td class="markdownTableBodyNone">&mdash;   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md86"></a>
Software</h1>
<h2><a class="anchor" id="autotoc_md87"></a>
User Options</h2>
<p>In the main.cpp example files. There are four sections in "Setup()" function where user can make adjustments to select for SPI type used, PCB type used and screen size.</p>
<p>0. USER OPTION 0 SPI_SPEED + TYPE</p><ol type="1">
<li>USER OPTION 1 GPIO</li>
<li>USER OPTION 2 SCREEN SECTION</li>
</ol>
<p><em>USER OPTION 0 SPI SPEED</em></p>
<p>Here the user can pass the SPI Bus freq in kiloHertz, Currently set to 8 Mhz. Max SPI speed on the PICO is 62.5Mhz. There is a file with SPI test results for the FPS tests in extra/doc folder. 2nd parameter is the SPI interface(spi0 spi1 etc).</p>
<p>If users wants software SPI just call this method with just one argument for the optional GPIO software uS delay, which by default is zero. Setting this higher can be used to slow down Software SPI which may be beneficial in some setups. <br  />
</p>
<p><em>USER OPTION 1 GPIO</em></p>
<p>The 5 GPIO pins used, the clock and data lines must be the clock and data lines of spi interface chosen in option 0 if using hardware SPI. If no reset pin on display or hat, pass -1 as argument to disable reset pin.</p>
<p><em>USER OPTION 2 Screen size + Offsets</em></p>
<p>In the main.cpp file, in USER OPTION 2 . User can adjust screen pixel height, screen pixel width and x &amp; y screen offsets. These offsets can be used in the event of screen damage or manufacturing errors around edge such as cropped data or defective pixels. The function TFTInitScreenSize sets them.</p>
<h2><a class="anchor" id="autotoc_md88"></a>
Bitmap</h2>
<p>Functions to support drawing bitmaps,</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Num   </th><th class="markdownTableHeadNone">Function Name   </th><th class="markdownTableHeadNone">Colour support   </th><th class="markdownTableHeadNone">test bitmap data size   </th><th class="markdownTableHeadNone">Note    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">drawBitmap   </td><td class="markdownTableBodyNone">bi-colour   </td><td class="markdownTableBodyNone">2048 bytes   </td><td class="markdownTableBodyNone">Data horizontally addressed    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">drawBitmap8Data   </td><td class="markdownTableBodyNone">8 bit color RRRGGGBB   </td><td class="markdownTableBodyNone">16384   </td><td class="markdownTableBodyNone">Data from array on PICO, Converted by software to 16-bit color    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">drawBitmap16Data   </td><td class="markdownTableBodyNone">16 bit color 565   </td><td class="markdownTableBodyNone">32768   </td><td class="markdownTableBodyNone">Data from array on PICO    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">drawSpriteData   </td><td class="markdownTableBodyNone">16 bit color 565   </td><td class="markdownTableBodyNone">32768   </td><td class="markdownTableBodyNone">Data from array on PICO, Draws background color transparent   </td></tr>
</table>
<ol type="1">
<li>Bitmap size in kiloBytes = (screenWidth * screenHeight * bitsPerPixel)/(1024 * 8)</li>
<li>Math in bitmap size column assumes 128x128 bitmap.</li>
<li>The data array for 1 is created from image files using file data conversion tool <a href="https://javl.github.io/image2cpp/">link</a></li>
<li>The data array for 2-4 is created from BMP files using file data conversion tool <a href="https://notisrac.github.io/FileToCArray/">link</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md89"></a>
Hardware</h1>
<p>Connections as setup in main.cpp test file.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">TFT PinNum   </th><th class="markdownTableHeadNone">Pindesc   </th><th class="markdownTableHeadNone">HW SPI    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">LED   </td><td class="markdownTableBodyNone">VCC    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">SCLK   </td><td class="markdownTableBodyNone">GPIO18    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">SDA   </td><td class="markdownTableBodyNone">GPIO19    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">A0/DC   </td><td class="markdownTableBodyNone">GPIO3    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">RESET   </td><td class="markdownTableBodyNone">GPIO4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone">SS/CS   </td><td class="markdownTableBodyNone">GPIO2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">7   </td><td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone">GND    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">VCC   </td><td class="markdownTableBodyNone">VCC   </td></tr>
</table>
<ol type="1">
<li>NOTE connect LED backlight pin 1 thru a resistor to 3.3/5V VCC.</li>
<li>This is a 3.3V logic device do NOT connect the I/O logic lines to 5V logic device.</li>
<li>You can connect VCC to 5V if there is a 3.3 volt regulator on back of TFT module.</li>
<li>SW SPI pick any GPIO you like , HW SPI SCLK and SDA will be tied to spio interface.</li>
<li>Backlight on/off control is left to user.</li>
<li>If no reset pin on display or hat, pass -1 as argument to disable.</li>
<li>To operate without CS pin: pass -1 as argument for CS pin number in SetupGPIO()function and ground the CS pin on device side.</li>
</ol>
<h1><a class="anchor" id="autotoc_md90"></a>
Output</h1>
<p><a href="https://github.com/gavinlyonsrepo/Display_Lib_RPI/blob/main/extra/images/st7789output.jpg"><img src="https://github.com/gavinlyonsrepo/Display_Lib_RPI/blob/main/extra/images/st7789output.jpg" alt="output pic" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md91"></a>
Notes</h1>
<h2><a class="anchor" id="autotoc_md92"></a>
Display offsets</h2>
<p>The display initialisation requires an offset calculation which differs for different size and resolution displays. This is in the code(Function AdjustWidthHeight()) but the many different size displays are not available for testing or dealt with. If using a display other than 240x320(the default and size of ST7789 video ram , VRAM) and if user finds they cannot address all screen or their data is offset. Try Setting the pixel width and height of your screen to 240X320 and do not write as much as possible to the part of the VRAM you cannot see. For example if you have a 240X280 display in 0 degree rotation, the VRAM is same for ALL displays sizes.</p><ol type="1">
<li>Set pixel Width = 240 and pixel height = 320</li>
<li>Do not write to the missing 40 pixels in the Y-axis, you still can but it is inefficient.</li>
</ol>
<p><a href="https://github.com/gavinlyonsrepo/displaylib_16bit_PICO/blob/main/extra/image/offset_st7789.png"><img src="https://github.com/gavinlyonsrepo/displaylib_16bit_PICO/blob/main/extra/image/offset_st7789.png" alt="pic " class="inline"/></a></p>
<p>Also if you have a 240x135 size display and you see the issue described in <a href="https://github.com/gavinlyonsrepo/displaylib_16bit_PICO/issues/10">github issue 10</a> You can alternately apply the fix there to function AdjustWidthHeight(). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
